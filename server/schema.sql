PRAGMA foreign_keys = ON;

DROP TABLE IF EXISTS users;
CREATE TABLE users (
    userid INTEGER PRIMARY KEY AUTOINCREMENT,
    created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    username TEXT NOT NULL,
    passwd TEXT NOT NULL,
    email TEXT NOT NULL,
    name TEXT NOT NULL,
    status INTEGER NOT NULL
);

DROP TABLE IF EXISTS desks;
CREATE TABLE desks (
    deskid INTEGER PRIMARY KEY AUTOINCREMENT,
    created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    macaddress TEXT NOT NULL,
    location TEXT NOT NULL
);

DROP TABLE IF EXISTS heights;
CREATE TABLE heights (
    heightid INTEGER PRIMARY KEY AUTOINCREMENT,
    created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    time INTEGER NOT NULL,
    userid INTEGER NOT NULL,
    height REAL NOT NULL
);

DROP TABLE IF EXISTS actions;
CREATE TABLE actions (
    actionid INTEGER PRIMARY KEY AUTOINCREMENT,
    created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    time INTEGER NOT NULL,
    userid INTEGER NOT NULL,
    action TEXT NOT NULL -- manual keypresses, interface actions, and automatic actions
);

DROP TABLE IF EXISTS deskjoins;
CREATE TABLE deskjoins (
    deskjoinid INTEGER PRIMARY KEY AUTOINCREMENT,
    created TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
    end TIMESTAMP,
    deskid INTEGER NOT NULL,
    userid INTEGER NOT NULL
);

